@*
    For more information on enabling MVC for empty projects, visit http://go.microsoft.com/fwlink/?LinkID=397860
*@
<link rel="stylesheet" href="~/css/PartialViewCss/DownloadFiles.css" />
<h1 style="margin-top: 70px">Завантажте свої бази даних</h1>
<hr />
<div class="container-fluid">
    <div class="container-fluid" id="containerChooseDB">

        <div class="col-md-6 container-fluid" id="sourceBD">
            <div class="col-md-12">
                <h2 class="text-center"> Підключення до "Джерела"</h2>
            </div>
            <hr class='custom-hr' />
            <div class="containerChooseSource container-fluid">
                <ul class="list-inline list-db text-center">
                    <li>
                        <div class="parent">
                            <label class="btn">
                                <img class="image-db-source" src="~/images/SqlServerChoose.svg" alt="SqlServer" srcset="" style="width: 15vmin;height: 15vmin;">
                                <input type="radio" name="dbCheck" id="dbCheck" value="SQLServer" class="hidden" autocomplete="off">
                                <img class="img-ok-source hidden" src="~/images/OK.svg" style="width: 0vmin;height: 0vmin;" />
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="parent">
                            <label class="btn">
                                <img class="image-db-source" src="~/images/MySqlChoose.svg" alt="MySql" srcset="" style="width: 15vmin;height: 15vmin;">
                                <input type="radio" name="dbCheck" id="dbCheck" value="MySQL" class="hidden" autocomplete="off">
                                <img class="img-ok-source hidden" src="~/images/OK.svg" style="width: 5vmin;height: 5vmin;" />
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="parent">
                            <label class="btn">
                                <img class="image-db-source" src="~/images/SqlLite.svg" alt="SQLite" srcset="" style="width: 15vmin;height: 15vmin;">
                                <input type="radio" name="dbCheck" id="dbCheck" value="SQLite" class="hidden" autocomplete="off">
                                <img class="img-ok-source hidden" src="~/images/OK.svg" style="width: 5vmin;height: 5vmin;" />
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="parent">
                            <label class="btn">
                                <img class="image-db-source" src="~/images/postgreSQL.svg" alt="MySql" srcset="" style="width: 15vmin;height: 15vmin;">
                                <input type="radio" name="dbCheck" id="dbCheck" value="PostgreSQL" class="hidden" autocomplete="off">
                                <img class="img-ok-source hidden" src="~/images/OK.svg" style="width: 5vmin;height: 5vmin;" />
                            </label>
                        </div>
                    </li>
                </ul>
            </div>
            <hr class='custom-hr' />
            <div id="chooseConnect-source-div"></div>
            <div id="connectTo-source-div"></div>
        </div>
        <div class="col-md-6 container-fluid" id="targetBD">
            <div class="col-md-12">
                <h2 class="text-center">Підключення до "Цілі"</h2>
            </div>
            <hr class='custom-hr' />
            <div class="containerChooseTarget container-fluid">
                <ul class="list-inline list-db text-center">
                    <li>
                        <div class="parent">
                            <label class="btn">
                                <img class="image-db-target" src="~/images/SqlServerChoose.svg" alt="SQLServer" srcset="" style="width: 15vmin;height: 15vmin;">
                                <input type="radio" name="dbCheckTarget" id="dbCheck" value="SQLServer" class="hidden" autocomplete="off">
                                <img class="img-ok-target hidden" src="~/images/OK.svg" style="width: 0vmin;height: 0vmin;" />
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="parent">
                            <label class="btn">
                                <img class="image-db-target" src="~/images/MySqlChoose.svg" alt="MySql" srcset="" style="width: 15vmin;height: 15vmin;">
                                <input type="radio" name="dbCheckTarget" id="dbCheck" value="MySQL" class="hidden" autocomplete="off">
                                <img class="img-ok-target hidden" src="~/images/OK.svg" style="width: 5vmin;height: 5vmin;" />
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="parent">
                            <label class="btn">
                                <img class="image-db-target" src="~/images/SqlLite.svg" alt="SQLite" srcset="" style="width: 15vmin;height: 15vmin;">
                                <input type="radio" name="dbCheckTarget" id="dbCheck" value="SQLite" class="hidden" autocomplete="off">
                                <img class="img-ok-target hidden" src="~/images/OK.svg" style="width: 5vmin;height: 5vmin;" />
                            </label>
                        </div>
                    </li>
                    <li>
                        <div class="parent">
                            <label class="btn">
                                <img class="image-db-target" src="~/images/postgreSQL.svg" alt="PostgreSQL" srcset="" style="width: 15vmin;height: 15vmin;">
                                <input type="radio" name="dbCheckTarget" id="dbCheck" value="PostgreSQL" class="hidden" autocomplete="off">
                                <img class="img-ok-target hidden" src="~/images/OK.svg" style="width: 5vmin;height: 5vmin;" />
                            </label>
                        </div>
                    </li>
                </ul>
            </div>
            <hr class='custom-hr' />
            <div id="chooseConnect-target-div"></div>
            <div id="connectTo-target-div"></div>
        </div>
    </div>
    @*First Upload File*@
    @*<div class="row">
            <div class="container-fluid col-md-6" id="Drop1">
                <form action="/Home/Upload/?id=1" class="dropzone dz-clickable dropable" id="Upload1"></form>
                <div class="panel" style="visibility:hidden" id="Res1">
                    <div class="panel-heading"></div>
                </div>
            </div>

            <div class="container-fluid col-md-6" id="Drop2">
                <form action="/Home/Upload/?id=2" class="dropzone dz-clickable dropable" id="Upload2"></form>
                <div class="panel" style="visibility:hidden" id="Res2">
                    <div class="panel-heading"></div>
                </div>
            </div>
        </div>*@
    @* <h6><button type="button" class="btn-lg" id="NextStep">NEXT STEP</button></h6>*@
    <button type="button" class="btn-lg btn-block btn-primary-custom" id="GoTableInfo">Обрати таблиці для порівняння</button>
    <button type="button" class="btn-lg btn-block btn-default-custom" id="Back" style="margin-bottom:1.5vmin;">Назад</button>
    
    <div class="modal fade" id="connModal" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Статус з'єднання</h4>
                </div>
                <div class="modal-body">
                    <h1>Віддалене з'єднання встановлено</h1>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Закрити</button>
                </div>
            </div>
        </div>
    </div>
    
    <div class="modal fade" id="connFailedModal" role="dialog">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Статус з'єднання</h4>
                </div>
                <div class="modal-body">
                    <h1>Віддалене з'єднання не встановлено</h1>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Закрити</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="~/js/dropzone.js"></script>

<script>
    //only numbers validation
    function validate(evt) {
        var theEvent = evt || window.event;
        var key = theEvent.keyCode || theEvent.which;
        key = String.fromCharCode(key);
        var regex = /[0-9]|\./;
        if (!regex.test(key)) {
            theEvent.returnValue = false;
            if (theEvent.preventDefault) theEvent.preventDefault();
        }
    }
    //transition to next view
    $("#GoTableInfo").click(function () {
        if ((screen.width >= 1920) && (screen.height >= 1080)) {
            waitingDialog.show("Завантаження даних...");
            $.ajax({
                url: "TableInfo",
                type: "POST",
                success: function (result) {
                    waitingDialog.hide();
                    $("#Partial").html(result);
                }
            });
        } else {
            waitingDialog.show("Завантаження даних...");
            $.ajax({
                url: "SmallTableInfo",
                type: "POST",
                success: function (result) {
                    waitingDialog.hide();
                    $("#Partial").html(result);
                }
            });
        }
    });

    //function for show connection result info
    function ReturnInfo(elem, result) {
        $(elem).css("visibility", "visible");
        $(elem).removeClass("panel-danger panel-success");
        if (result == true) {
            $(elem).find("div").text("З'єднання встановлено");
            $(elem).addClass("panel-success");
        }
        else {
            $(elem).find("div").text("З'єднання не встановлено!");
            $(elem).addClass("panel-danger");
        }
    }

    $(function () {
        //Dropzone.options.Upload1 = {
        //    uploadMultiple: false,
        //    timeout: 9999999,
        //    acceptedFiles: ".mdf,.sql,.xml",
        //};
        //Dropzone.options.Upload2 = Dropzone.options.Upload1;

        //var dropzones = $(".dropable").toArray();

        //dropzones.forEach(function (item, i, dropzones) {
        //    $(item).dropzone({
        //        url: "/Home/Upload/?id=" + (i + 1),
        //        success: function (file, response) {
        //            if (response == true)
        //                ReturnInfo($(item).parent().find(".panel"), response);
        //            else
        //                $('#myModal').modal('show');
        //        }
        //    });
        //});
    });

    // button baack for previous view
    $("#Back").click(function () {
        waitingDialog.show("Завантаження даних...");
        $.ajax({
            url: "Index",
            type: "POST",
            success: function (result) {
                waitingDialog.hide();
                $("#Partial").html(result);
            }
        });
    });
    //generate button choose SQL database
    function chooseSQL_DB(IDbackToChoose, IDbtn_connectToSql_file, IDbtn_connectToSql_remote) {
        var _chooseSQL_DB = "<hr class='custom-hr'/>" + "<div class='containerConnect container-fluid'>" +
            "<button type='button' class='btn btn-block btn-File-Remote' id=" + IDbtn_connectToSql_file +
            ">Підключення до файлу</button>" +
            "<button type='button' class='btn btn-block btn-File-Remote' id=" + IDbtn_connectToSql_remote +
            ">Віддалене підключення</button>" +
            "</div>" +
            "<div class='containerConnect container-fluid  text-center'>" +
            "<div class='wrapper-btn'>" +
            " <button id=" + IDbackToChoose + " class='btn-back' type='submit'>Назад</button>" +
            "</div>" +
            "</div>" + "<hr class='custom-hr'/>";
        return _chooseSQL_DB;
    }
    //generate button choose MySQL database
    function chooseMySQL_DB(IDbackToChoose, IDbtn_connectToMySql_remote, IDbtn_connectToSql_file) {
        var _chooseMySQL_DB = "<hr class='custom-hr'/>" + "<div class='containerConnect container-fluid'>" +
            "<button type='button' class='btn btn-block btn-File-Remote' id=" + IDbtn_connectToSql_file +
            ">Підключення до файлу</button>" +
            "<button type='button' class='btn btn-block btn-File-Remote' id=" + IDbtn_connectToMySql_remote +
            ">Віддалене підключення</button>" +
            "</div>" +
            "<div class='containerConnect container-fluid  text-center'>" +
            "<div class='wrapper-btn'>" +
            " <button id=" + IDbackToChoose + " class='btn-back' type='submit'>Назад</button>" +
            "</div>" +
            "</div>" + "<hr class='custom-hr'/>";
        return _chooseMySQL_DB;
    }
    //generate button choose SqlLite database
    function chooseSqlLite_DB(IDbackToChoose, IDbtn_connectToSqlLite_file) {
        var _chooseSqlLite_DB = "<hr class='custom-hr'/>" + "<div class='containerConnect container-fluid'>" +
            "<button type='button' class='btn btn-block btn-File-Remote' id=" + IDbtn_connectToSqlLite_file +
            ">Підключення до файлу</button>" +
            "</div>" +
            "<div class='containerConnect container-fluid  text-center'>" +
            "<div class='wrapper-btn'>" +
            " <button id=" + IDbackToChoose + " class='btn-back' type='submit'>Назад</button>" +
            "</div>" +
            "</div>" + "<hr class='custom-hr'/>";
        return _chooseSqlLite_DB;
    }
    //generate button choose PostgreSQL database
    function choosePostgreSQL_DB(IDbackToChoose, IDbtn_connectToPostgreSQL_file) {
        var _choosePostgreSQL_DB = "<hr class='custom-hr'/>" + "<div class='containerConnect container-fluid'>" +
            "<button type='button' class='btn btn-block btn-File-Remote' id=" + IDbtn_connectToPostgreSQL_file +
            ">Підключення до файлу</button>" +
            "</div>" +
            "<div class='containerConnect container-fluid  text-center'>" +
            "<div class='wrapper-btn'>" +
            " <button id=" + IDbackToChoose + " class='btn-back' type='submit'>Назад</button>" +
            "</div>" +
            "</div>" + "<hr class='custom-hr'/>";
        return _choosePostgreSQL_DB;
    }
    //connect to file function
    function connectToFile(ID_my_dropzon_div, ID_my_dropzon, IdUpload, backToChooseConnect) {
        var _connectToFile = "<hr class='custom-hr'/>" +
            '<div class=" containerConnect container-fluid col-md-12" id=' + ID_my_dropzon_div + '>' +
            '            <form action="/Home/Upload/?id=' + IdUpload + '" class="dropzone dz-clickable dropable" id=' + ID_my_dropzon + '></form>' +
            '            <div class="panel" style="visibility:hidden" id="Res1">' +
            "                <div class='panel-heading'></div>" +
            "            </div>" +
            "      </div>" +
            " <div class='containerConnect container-fluid col-md-12 text-center'>" +
            "<div class='wrapper-btn'>" +
            " <button id=" + backToChooseConnect + " class='btn-back' type='submit'>Назад</button>" +
            "</div>" + "</div>" + "<hr class='custom-hr'/>";

        return _connectToFile;
    }
    //remote connection function
    function connectToRemote(classDb, Id_btnNext, Id_btnBack) {
        var _connectToRemote = "<hr class='custom-hr'/>" + "<div class='containerConnect container-fluid'>" +
            " <div>" +
            "<div class='form-group'>" +
            "<label for='userName'>User name</label>" +
            "<input type='text' class='form-control " + classDb + " ' id='user' placeholder='Enter User name'>" +
            "</div>" +
            "<div class='form-group'>" +
            "<label for= 'password'>User password</label>" +
            "<input type='password' class='form-control " + classDb + "' id = 'pass'  placeholder='Enter db password'>" +
            "</div>" +
            "<div class='form-group'>" +
            "<label for= 'db'>Database name</label>" +
            "<input type='text' class='form-control " + classDb + "' id = 'db'  placeholder='Enter db name'>" +
            "</div>" +
            "<div class='form-group'>" +
            "<label for='ip'>IP address</label>" +
            "<input type='text' class='form-control " + classDb + "' id='ip' placeholder='Enter IP' onkeypress='validate(event)'>" +
            "</div>" +
            "<div class='form-group'>" +
            "<label for='Id_port'>Port</label>" +
            "<input type='text' class='form-control " + classDb + "' id='port' placeholder='Enter Port' onkeypress='validate(event)'>" +
            "</div>" +
            "<button class='btn btn-block btn-primary'id =" + Id_btnNext + ">З'єднання</button>" +
            "<small id='emailHelp' class='form-text text-muted'>We'll never share your credits with anyone else.</small>" +
            "</div>" +
            "<div class='containerConnect container-fluid  text-center'>" +
            "<div class='wrapper-btn'>" +
            " <button id=" + Id_btnBack + " class='btn-back' type='submit'>Назад</button>" +
            "</div>" +
            "</div>" +
            "</div>" +
            '            <div class="panel" style="visibility:hidden"' +
            "                <div class='panel-heading'></div>" +
            "            </div>" +
            "<hr class='custom-hr'/>";
        return _connectToRemote;
    }
    //add remote connection credits to Json
    function findRemoteConVal(classDB) {
        var items = document.getElementsByClassName(classDB);
        var JSon = {};
        for (var i = 0; i < items.length; i++) {
            JSon[items[i].id] = items[i].value,
                console.log(items[i].value);
        }
        return JSon;
    }

    //source db generate front-end
    $(document).ready(function (e) {
        //image with check
        $('.image-db-source').click(function (e) {
            $('.image-db-source').not(this).removeClass('check')
                .siblings('input').prop('checked', false);
            $(this).addClass('check')
                .siblings('input').prop('checked', true);

            $('.img-ok-source').not(this).addClass('hidden')
            $(this).siblings('img').removeClass("hidden");
            $(this).siblings('img').css({
                'width': '0vmin',
                'height': '0vmin'
            })
            $(this).siblings('img').animate({
                width: '5vmin',
                height: '5vmin'
            });
            //first back button
            function backToChooseSourceDB_Source() {
                $("#backToChooseSource").click(function () {
                    $("#chooseConnect-source-div").empty();
                    $(".containerChooseSource").removeClass("inactiveDiv");
                    $('.img-ok-source').addClass('hidden');
                    $('.image-db-source').removeClass('check');
                });
            };
            //second back button
            function backToChooseConnect_Source() {
                $("#backToChooseConnect").click(function () {
                    $("#connectTo-source-div").empty();
                    $("#chooseConnect-source-div").removeClass("inactiveDiv");
                });
            };
            //choose db type
            var SourcedbType = "";
            SourcedbType = $("input[name=dbCheck]:checked").val();
            switch (SourcedbType) {
                //choose mySql
                case "MySQL":
                    $("#chooseConnect-source-div").empty().append(chooseMySQL_DB("backToChooseSource",
                        "btn-connectToMySql-remote", "btn-connectToMySql-file"));
                    $(".containerChooseSource").addClass("inactiveDiv");
                    backToChooseSourceDB_Source();

                    $('#btn-connectToMySql-file').click(function () {
                        $("#connectTo-source-div").empty().append(connectToFile("Drop1", "Upload1", 1,
                            "backToChooseConnect"));
                        $("#chooseConnect-source-div").addClass("inactiveDiv");

                        backToChooseConnect_Source();

                        Dropzone.options.Upload1 = {
                            uploadMultiple: false,
                            timeout: 9999999,
                            acceptedFiles: ".sql",
                        };
                        //upload db
                        $("#Upload1").dropzone({
                            url: "/Home/Upload/?id=1&type=" + SourcedbType,
                            success: function (file, response) {
                                if (response == true)
                                    ReturnInfo($("#Upload1").parent().find(".panel"), response);
                                else
                                    $('#myModal').modal('show');

                            }
                        });

                    });
                    //generate remote connection to MySql
                    $('#btn-connectToMySql-remote').click(function () {
                        $("#connectTo-source-div").empty().append(connectToRemote('sourceDB', 'RemoteConnSource', 'backToChooseConnect'));
                        $("#chooseConnect-source-div").addClass("inactiveDiv");
                        backToChooseConnect_Source();
                        $("#RemoteConnSource").click(function () {
                            //json data for remote
                            var returnVal = findRemoteConVal('sourceDB');
                            returnVal["from"] = "source";
                            returnVal["dbType"] = SourcedbType;
                            returnVal = JSON.stringify(returnVal);
                            console.log(returnVal);
                            $.ajax({
                                async: true,
                                url: "RemoteAccess",
                                type: "POST",
                                data: { data: returnVal },
                                success: function (response) {
                                    if (response == true)
                                       // ReturnInfo($(".sourceDB").first().parent().parent().find(".panel"), response);
                                        $("#connModal").modal('show');
                                    else
                                        $('#connFailedModal').modal('show');
                                }
                            });
                        });
                    });

                    break;

                case "SQLServer":
                    $("#chooseConnect-source-div").empty().append(chooseSQL_DB("backToChooseSource",
                        "btn-connectToSql-file", "btn-connectToSql-remote"));
                    $(".containerChooseSource").addClass("inactiveDiv");
                    backToChooseSourceDB_Source();
                    $('#btn-connectToSql-file').click(function () {
                        $("#connectTo-source-div").empty().append(connectToFile("Drop1", "Upload1", 1,
                            "backToChooseConnect"));
                        $("#chooseConnect-source-div").addClass("inactiveDiv");

                        backToChooseConnect_Source();

                        Dropzone.options.Upload1 = {
                            uploadMultiple: false,
                            timeout: 9999999,
                            acceptedFiles: ".mdf",
                        };
                        //upload db
                        $("#Upload1").dropzone({
                            url: "/Home/Upload/?id=1&type=" + SourcedbType,
                            success: function (file, response) {
                                if (response == true)
                                    ReturnInfo($("#Upload1").parent().find(".panel"), response);
                                else
                                    $('#myModal').modal('show');

                            }
                        });

                    });

                    $('#btn-connectToSql-remote').click(function () {
                        $("#connectTo-source-div").empty().append(connectToRemote('sourceDB', 'RemoteConnSource', 'backToChooseConnect'));
                        $("#chooseConnect-source-div").addClass("inactiveDiv");
                        backToChooseConnect_Source();
                        $("#RemoteConnSource").click(function () {

                            var returnVal = findRemoteConVal('sourceDB');
                            returnVal["from"] = "source";
                            returnVal["dbType"] = SourcedbType;
                            returnVal = JSON.stringify(returnVal);
                            console.log(returnVal);
                            $.ajax({
                                async: true,
                                url: "RemoteAccess",
                                type: "POST",
                                data: { data: returnVal },
                                success: function (response) {
                                    if (response == true)
                                       // ReturnInfo($(".sourceDB").first().parent().parent().find(".panel"), response);
                                        $("#connModal").modal('show');
                                    else
                                        $('#connFailedModal').modal('show');
                                }
                            });
                        });
                    });
                    break;


                case "SQLite":
                    $("#chooseConnect-source-div").empty().append(chooseSqlLite_DB("backToChooseSource",
                        "btn-connectSQLite-file"));
                    $(".containerChooseSource").addClass("inactiveDiv");
                    backToChooseSourceDB_Source();
                    $('#btn-connectSQLite-file').click(function () {
                        $("#connectTo-source-div").empty().append(connectToFile("Drop1", "Upload1", 1,
                            "backToChooseConnect"));
                        $("#chooseConnect-source-div").addClass("inactiveDiv");

                        backToChooseConnect_Source();

                        Dropzone.options.Upload1 = {
                            uploadMultiple: false,
                            timeout: 9999999,
                            acceptedFiles: ".db",
                        };
                        //upload db
                        $("#Upload1").dropzone({
                            url: "/Home/Upload/?id=1&type=" + SourcedbType,
                            success: function (file, response) {
                                if (response == true)
                                    ReturnInfo($("#Upload1").parent().find(".panel"), response);
                                else
                                    $('#myModal').modal('show');

                            }
                        });
                    });
                    break;

                case "PostgreSQL":
                    $("#chooseConnect-source-div").empty().append(choosePostgreSQL_DB("backToChooseSource",
                        "btn-connectPostgreSQL-file"));
                    $(".containerChooseSource").addClass("inactiveDiv");
                    backToChooseSourceDB_Source();
                    $('#btn-connectPostgreSQL-file').click(function () {
                        $("#connectTo-source-div").empty().append(connectToFile("Drop1", "Upload1", 1,
                            "backToChooseConnect"));
                        $("#chooseConnect-source-div").addClass("inactiveDiv");

                        backToChooseConnect_Source();

                        Dropzone.options.Upload1 = {
                            uploadMultiple: false,
                            timeout: 9999999,
                            acceptedFiles: ".sql",
                        };
                        //upload db
                        $("#Upload1").dropzone({
                            url: "/Home/Upload/?id=1&type=" + SourcedbType,
                            success: function (file, response) {
                                if (response == true)
                                    ReturnInfo($("#Upload1").parent().find(".panel"), response);
                                else
                                    $('#myModal').modal('show');

                            }
                        });
                    });
                    break;

                case "none":
                    alert("kurrwa");
                    break;
            }
        });
    });

    //target db genetate front-end
    $(document).ready(function (e) {
        //image with check
        $('.image-db-target').click(function (e) {
            $('.image-db-target').not(this).removeClass('check')
                .siblings('input').prop('checked', false);
            $(this).addClass('check')
                .siblings('input').prop('checked', true);

            $('.img-ok-target').not(this).addClass('hidden')
            $(this).siblings('img').removeClass("hidden");
            $(this).siblings('img').css({
                'width': '0vmin',
                'height': '0vmin'
            })
            $(this).siblings('img').animate({
                width: '5vmin',
                height: '5vmin'
            });
            //first back button
            function backToChooseSourceDB_Target() {
                $("#backToChooseTarget").click(function () {
                    $("#chooseConnect-target-div").empty();
                    $(".containerChooseTarget").removeClass("inactiveDiv");
                    $('.img-ok-target').addClass('hidden');
                    $('.image-db-target').removeClass('check')
                });
            };
            //second back button
            function backToChooseConnect_Target() {
                $("#backToChooseConnectTarget").click(function () {
                    $("#connectTo-target-div").empty();
                    $("#chooseConnect-target-div").removeClass("inactiveDiv");
                });
            };
            //choose db type
            var TargetdbType = "";
            TargetdbType = $("input[name=dbCheckTarget]:checked").val();
            switch (TargetdbType) {
                case "MySQL":
                    $("#chooseConnect-target-div").empty().append(chooseMySQL_DB("backToChooseTarget",
                        "btn-connectToMySql-remote-target", "btn-connectToMySql-file-target"));
                    $(".containerChooseTarget").addClass("inactiveDiv");
                    backToChooseSourceDB_Target();

                    $('#btn-connectToMySql-file-target').click(function () {
                        $("#connectTo-target-div").empty().append(connectToFile("Drop2", "Upload2", 2,
                            "backToChooseConnectTarget"));
                        backToChooseConnect_Target();
                        $("#chooseConnect-target-div").addClass("inactiveDiv");

                        Dropzone.options.Upload2 = {
                            uploadMultiple: false,
                            timeout: 9999999,
                            acceptedFiles: ".sql",
                        };
                        //upload file
                        $("#Upload2").dropzone({
                            url: "/Home/Upload/?id=2&type=" + TargetdbType,
                            success: function (file, response) {
                                if (response == true)
                                    ReturnInfo($("#Upload2").parent().find(".panel"), response);
                                else
                                    $('#myModal').modal('show');

                            }
                        });
                    });

                    $('#btn-connectToMySql-remote-target').click(function () {
                        $("#connectTo-target-div").empty().append(connectToRemote('targetDB', 'RemoteConnTarget', 'backToChooseConnectTarget'));
                        $("#chooseConnect-target-div").addClass("inactiveDiv");
                        backToChooseConnect_Target();
                        $("#RemoteConnTarget").click(function () {
                            
                            var returnVal = findRemoteConVal('targetDB');
                            returnVal["from"] = "target";
                            returnVal["dbType"] = TargetdbType;
                            returnVal = JSON.stringify(returnVal);
                            console.log(returnVal);
                            $.ajax({
                                async: true,
                                url: "RemoteAccess",
                                type: "POST",
                                data: { data: returnVal },
                                success: function (response) {
                                    if (response == true)
                                      //  ReturnInfo($(".targetDB").first().parent().parent().find(".panel"), response);
                                        $("#connModal").modal('show');

                                    else
                                        $('#connFailedModal').modal('show');
                                }
                            });
                        });
                    });
                    break;

                case "SQLServer":
                    $("#chooseConnect-target-div").empty().append(chooseSQL_DB("backToChooseTarget",
                        "btn-connectToSql-file-target", "btn-connectToSql-remote-target"));
                    $(".containerChooseTarget").addClass("inactiveDiv");
                    backToChooseSourceDB_Target();
                    $('#btn-connectToSql-file-target').click(function () {
                        $("#connectTo-target-div").empty().append(connectToFile("Drop2", "Upload2", 2,
                            "backToChooseConnectTarget"));
                        backToChooseConnect_Target();
                        $("#chooseConnect-target-div").addClass("inactiveDiv");

                        Dropzone.options.Upload2 = {
                            uploadMultiple: false,
                            timeout: 9999999,
                            acceptedFiles: ".mdf",
                        };
                        //upload file
                        $("#Upload2").dropzone({
                            url: "/Home/Upload/?id=2&type=" + TargetdbType,
                            success: function (file, response) {
                                if (response == true)
                                    ReturnInfo($("#Upload2").parent().find(".panel"), response);
                                else
                                    $('#myModal').modal('show');
                            }
                        });

                    });

                    $('#btn-connectToSql-remote-target').click(function () {
                        $("#connectTo-target-div").empty().append(connectToRemote('targetDB', 'RemoteConnTarget', 'backToChooseConnectTarget'));
                        $("#chooseConnect-target-div").addClass("inactiveDiv");
                        backToChooseConnect_Target();
                        $("#RemoteConnTarget").click(function () {

                            var returnVal = findRemoteConVal('targetDB');
                            returnVal["from"] = "target";
                            returnVal["dbType"] = TargetdbType;
                            returnVal = JSON.stringify(returnVal);
                            console.log(returnVal);
                            $.ajax({
                                async: true,
                                url: "RemoteAccess",
                                type: "POST",
                                data: { data: returnVal },
                                success: function (response) {
                                    if (response == true)
                                        //ReturnInfo($(".targetDB").first().parent().find(".panel"), response);
                                        $("#connModal").modal('show');
                                    else
                                        $('#connFailedModal').modal('show');
                                }
                            });
                        });
                    });
                    break;

                case "SQLite":
                    $("#chooseConnect-target-div").empty().append(choosePostgreSQL_DB("backToChooseTarget",
                        "btn-connectToSQLite-file-target"));
                    $(".containerChooseTarget").addClass("inactiveDiv");
                    backToChooseSourceDB_Target();
                    $('#btn-connectToSQLite-file-target').click(function () {
                        $("#connectTo-target-div").empty().append(connectToFile("Drop2", "Upload2", 2,
                            "backToChooseConnectTarget"));
                        backToChooseConnect_Target();
                        $("#chooseConnect-target-div").addClass("inactiveDiv");

                        Dropzone.options.Upload2 = {
                            uploadMultiple: false,
                            timeout: 9999999,
                            acceptedFiles: ".db",
                        };
                        //upload file
                        $("#Upload2").dropzone({
                            url: "/Home/Upload/?id=2&type=" + TargetdbType,
                            success: function (file, response) {
                                if (response == true)
                                    ReturnInfo($("#Upload2").parent().find(".panel"), response);
                                else
                                    $('#myModal').modal('show');
                            }
                        });

                    });
                    break;

                case "PostgreSQL":
                    $("#chooseConnect-target-div").empty().append(choosePostgreSQL_DB("backToChooseTarget",
                        "btn-connectToPostgreSQL-file-target"));
                    $(".containerChooseTarget").addClass("inactiveDiv");
                    backToChooseSourceDB_Target();
                    $('#btn-connectToPostgreSQL-file-target').click(function () {
                        $("#connectTo-target-div").empty().append(connectToFile("Drop2", "Upload2", 2,
                            "backToChooseConnectTarget"));
                        backToChooseConnect_Target();
                        $("#chooseConnect-target-div").addClass("inactiveDiv");

                        Dropzone.options.Upload2 = {
                            uploadMultiple: false,
                            timeout: 9999999,
                            acceptedFiles: ".sql",
                        };
                        //upload file
                        $("#Upload2").dropzone({
                            url: "/Home/Upload/?id=2&type=" + TargetdbType,
                            success: function (file, response) {
                                if (response == true)
                                    ReturnInfo($("#Upload2").parent().find(".panel"), response);
                                else
                                    $('#myModal').modal('show');
                            }
                        });

                    });
                    break;
                case "none":
                    alert("some problem");
                    break;
            }
        });
    });


</script>